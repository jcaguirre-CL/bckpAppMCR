(function(){'use strict';angular.module('app').controller('generarGraficoController',generarGraficoController).service('GraficoService',GraficoService)
generarGraficoController.$inject=['$q','GraficoService'];function generarGraficoController($q,GraficoService){var graficos=this;var objShared={};var promise={};var selectParametroUno=document.getElementById("parametroUnoId");var selectParametroDos=document.getElementById("parametroDosId");graficos.dataArray=[];graficos.array=[];graficos.placeParametroUno="";graficos.placeParametroDos="";graficos.labels=["uno","dos","tres"];graficos.data=[300,500,100];graficos.options={};graficos.formData={};graficos.parametros=["Area de Falla","Tipo de Falla","Se単al","Servicio"];graficos.tipoGraficos=["Circular","Lineal"];graficos.placePlataforma="";graficos.valueParametroUno="Parametro";graficos.valueParametroDos="TipoGrafico";graficos.CurrentDate=new Date();graficos.selectParametroUno=function(){graficos.placeParametroUno=graficos.parametroUnoSelect;graficos.valueParametroUno=graficos.parametroUnoSelect;selectParametroUno.selectedIndex=0;console.log('selec parametroUnoSelect: '+graficos.valueParametroUno)};graficos.selectParametroDos=function(){graficos.placeParametroDos=graficos.parametroDosSelect;graficos.valueParametroDos=graficos.parametroDosSelect;selectParametroDos.selectedIndex=0;console.log('selec parametroDosSelect: '+graficos.valueParametroDos)};graficos.crearGrafico=function(parametro,tipografico,fechaIni,fechaFin){switch(parametro){case 'Area de Falla':graficos.array=["0","1","2","3","4"];parametro='areafalla';break;case 'Tipo de Falla':graficos.array=["0","1","2","3","4","5","6"];parametro='tipofalla';break;case 'Se単al':graficos.array=["0","1","2","3","4"];parametro='senal';break;case 'Servicio':graficos.array=["0","1","2","3","4"];parametro='servicio';break}
var promises=[];for(var i=0;i<graficos.array.length;i++){var promise=GraficoService.consulta3dvecesbyParameters(parametro.toLowerCase(),graficos.array[i],fechaIni,fechaFin);promises.push(promise)}
$q.all(promises).then(function(dataArray){graficos.dataArray=dataArray;console.log('Key: '+graficos.array[0]);console.log('Value: '+JSON.stringify(graficos.dataArray[0].data.value));console.log(parametro);var items=[];for(var i=0;i<graficos.array.length;i++){if(parametro==='areafalla'){var etiquetaGrafico="Area de Falla";switch(graficos.array[i]){case '0':items.push({label:"Sin mencionar",value:graficos.dataArray[i].data.value});break;case '1':items.push({label:"Sistema de Emision",value:graficos.dataArray[i].data.value});break;case '2':items.push({label:"Contenido de Emision",value:graficos.dataArray[i].data.value});break;case '3':items.push({label:"PGM en vivo",value:graficos.dataArray[i].data.value});break;case '4':items.push({label:"Equipo de la linea de TX",value:graficos.dataArray[i].data.value});break}}
if(parametro==='tipofalla'){var etiquetaGrafico="Tipo de Falla";switch(graficos.array[i]){case '0':items.push({label:"Sin mencionar",value:graficos.dataArray[i].data.value});break;case '1':items.push({label:"Audio",value:graficos.dataArray[i].data.value});break;case '2':items.push({label:"Video",value:graficos.dataArray[i].data.value});break;case '3':items.push({label:"Audio y Video",value:graficos.dataArray[i].data.value});break;case '4':items.push({label:"Equipo",value:graficos.dataArray[i].data.value});break;case '5':items.push({label:"Humana",value:graficos.dataArray[i].data.value});break;case '6':items.push({label:"Enlace",value:graficos.dataArray[i].data.value});break}}
if(parametro==='senal'){var etiquetaGrafico="Se単al";switch(graficos.array[i]){case '0':items.push({label:"Sin mencionar",value:graficos.dataArray[i].data.value});break;case '1':items.push({label:"Nacional SD",value:graficos.dataArray[i].data.value});break;case '2':items.push({label:"Nacional HD",value:graficos.dataArray[i].data.value});break;case '3':items.push({label:"Cable",value:graficos.dataArray[i].data.value});break;case '4':items.push({label:"Todas",value:graficos.dataArray[i].data.value});break}}
if(parametro==='servicio'){var etiquetaGrafico="Servicio";switch(graficos.array[i]){case '0':items.push({label:"Sin mencionar",value:graficos.dataArray[i].data.value});break;case '1':items.push({label:"Bien",value:graficos.dataArray[i].data.value});break;case '2':items.push({label:"Malo por audio",value:graficos.dataArray[i].data.value});break;case '3':items.push({label:"Malo por video",value:graficos.dataArray[i].data.value});break;case '4':items.push({label:"Malo por audio y video",value:graficos.dataArray[i].data.value});break}}}
console.log('graficos array: '+graficos.array);var propertiesObjectpie3d={type:"pie3d",id:"container-chart1",width:"700",height:"600",renderAt:"chart-container1",dataFormat:"json",dataSource:{chart:{subCaption:"Listado de la totalidad de eventos por plataforma/periodo",caption:"Eventos por: "+etiquetaGrafico,captionFontSize:"14",subcaptionFontSize:"10",subcaptionFontBold:"0",bgcolor:"#ffffff",bgAlpha:"70,80",bgRatio:"60, 40",paletteColors:"#0075c2,#1aaf5d,#f2c500,#f45b00,#8e0000,#f4000c,#00d5f4",use3DLighting:0,borderColor:"#EEEEEE",exportEnabled:"1",borderThickness:3,use3DLighting:"0",showShadow:"0",enableSmartLabels:"0",startingAngle:"0",showPercentValues:"1",showPercentInTooltip:"0",decimals:"1",captionFontSize:"14",subcaptionFontSize:"14",subcaptionFontBold:"0",toolTipColor:"#ffffff",toolTipBorderThickness:"0",toolTipBgColor:"#000000",toolTipBgAlpha:"80",toolTipBorderRadius:"2",toolTipPadding:"5",showHoverEffect:"1",showLegend:"1",legendBgColor:"#ffffff",legendBorderAlpha:"0",legendShadow:"0",legendItemFontSize:"10",legendItemFontColor:"#666666",useDataPlotColorForLabels:"1"},data:items}};var propertiesObjectmultiserieline2d={type:"msline",id:"container-chart1",width:"700",height:"600",renderAt:"chart-container1",dataFormat:"json",dataSource:{"chart":{"caption":"Eventos registrados la ultima semana/mes/a単o","subCaption":"Evaluando en base a parametro: "+parametro,"captionFontSize":"14","subcaptionFontSize":"14","subcaptionFontBold":"0","paletteColors":"#0075c2,#1aaf5d","bgcolor":"#ffffff","showBorder":"0","showShadow":"0","showCanvasBorder":"0","usePlotGradientColor":"0","legendBorderAlpha":"0","legendShadow":"0","showAxisLines":"0","showAlternateHGridColor":"0","divlineThickness":"1","divLineDashed":"1","divLineDashLen":"1","xAxisName":"Dias","showValues":"0"},"categories":[{"category":[{"label":"Lun"},{"label":"Mar"},{"label":"Mie"},{"label":"Jue"},{"label":"Vie"},{"label":"Sab"},{"label":"Dom"}]}],"dataset":[{"seriesname":"Plataforma1","data":[{"value":"15"},{"value":"13"},{"value":"25"},{"value":"1"},{"value":"19"},{"value":"2"},{"value":"12"}]},{"seriesname":"Plataforma2","data":[{"value":"1"},{"value":"10"},{"value":"20"},{"value":"10"},{"value":"10"},{"value":"10"},{"value":"2"}]}]}};if(tipografico==='Circular'){var containerChart1=new FusionCharts(propertiesObjectpie3d);containerChart1.render()}else{var containerChart1=new FusionCharts(propertiesObjectmultiserieline2d);containerChart1.render()}}).catch(function(errorResponse){console.log("Problemas al conectar con la API");console.log(errorResponse.message)})};$(function(){var links=$('.sidebar-links > div');links.on('click',function(){console.log('qqqqqq');links.removeClass('selected');$(this).addClass('selected')})})}
GraficoService.$inject=['$q','$http'];function GraficoService($q,$http){var service=this;service.consulta3dvecesbyParameters=function(key,value,fechaIni,fechaFin){var d=$q.defer();console.log('recuperar: '+key+"/"+value+"/"+fechaIni+"/"+fechaFin);var response=$http({method:"GET",url:("http://10.128.2.25:3000/api/queryTimesbyparameters/"+key+"/"+value+"/"+fechaIni+"/"+fechaFin)});d.resolve(response);return d.promise}
service.recuperarRegistros=function(){var response=$http({method:"GET",url:("http://10.128.2.25:3000/api")});console.log('recuperar: '+response.length);return response};service.recuperarUno=function(id){var response=$http({method:"GET",url:("http://10.128.2.25:3000/api/"+id)});console.log('recuperarUno: '+response.data);return response};service.crearRegistros=function(registro){var response=$http({method:"POST",url:("/api"),headers:{'Content-Type':'application/json'},data:registro});console.log('Insertado: '+registro);return response};service.modificarRegistros=function(registroID,objeto){var response=$http({method:"PUT",url:("/api/"+registroID),heardes:{'Content-Type':'application/json'},data:objeto});console.log('adentro del modificarRegistros: '+response);return response};service.eliminarRegistros=function(id){var response=$http({method:"DELETE",url:("/api/"+id),headers:{'Content-Type':'application/json'}});console.log('Borrado: '+response);return response}}})()
