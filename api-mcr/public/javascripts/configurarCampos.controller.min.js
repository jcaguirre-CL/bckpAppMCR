(function(){'use strict';angular.module('app').controller('configurarCamposController',configurarCamposController).service('CamposService',CamposService)
configurarCamposController.$inject=['$q','CamposService'];function configurarCamposController($q,CamposService){var campos=this;var promise={};var promiseEliminar={};var promiseActualizar={};var objeto="";var selectObjeto=document.getElementById("objetoSelect");campos.objetos=["Programas","Responsables","Operadores"];campos.listado=[];campos.selectObjeto=function(){campos.placeObjeto=campos.objetoSelect;campos.valueObjeto=campos.objetoSelect;selectObjeto.selectedIndex=0;objeto=campos.valueObjeto.toLowerCase();var promise=CamposService.recuperarObjeto(campos.valueObjeto.toLowerCase()).then(function(listado){var array=[];for(var i=0;i<listado.data.length;i++){array.push(listado.data[i].value)}
campos.listado=JSON.stringify(array).replace(/]|[[]/g,'');campos.listado=campos.listado.replace(/"/g,'');campos.listado=campos.listado.replace(/,/g,'\n')}).catch(function(errorResponse){console.log("Problemas al conectar con la API");})};campos.confirmar=function(arreglo){var promiseEliminar=CamposService.limpiarObjeto(objeto).then(function(response){var promises=[];for(var i=0;i<campos.listado.split('\n').length;i++){promises.push({"key":objeto,"value":campos.listado.split('\n')[i]})}
$q.all(promises).then(function(dataArray){var promiseActualizar=CamposService.actualizarObjeto(dataArray).then(function(response){}).catch(function(errorResponse){console.log("Problemas al conectar con la API")})})}).catch(function(errorResponse){console.log("Problemas al conectar con la API");})};$(function(){var links=$('.sidebar-links > div');links.on('click',function(){links.removeClass('selected');$(this).addClass('selected')})})}
CamposService.$inject=['$q','$http'];function CamposService($q,$http){var service=this;service.recuperarObjeto=function(objeto){var d=$q.defer();var response=$http({method:"GET",url:("http://10.128.2.25:3000/api/Campos/"+objeto)});d.resolve(response);return d.promise}
service.limpiarObjeto=function(objeto){var response=$http({method:"POST",url:("http://10.128.2.25:3000/api/Campos/remove/"+objeto),headers:{'Content-Type':'application/json'},});return response};service.actualizarObjeto=function(objeto){var response=$http({method:"POST",url:("http://10.128.2.25:3000/api/Campos/update/"),headers:{'Content-Type':'application/json'},data:objeto});return response}}})()
